<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}{% endblock %}</title>
  {% load django_bootstrap5 %}
  {% bootstrap_css %}
  {% bootstrap_messages %}
</head>
<body>

    {% block content %}

    <form id="uploadFileForm" method="post" enctype="multipart/form-data">
        {% csrf_token %}

        {% bootstrap_form form layout=layout %}

        {% bootstrap_button button_type="submit" content="OK" %}
        {% bootstrap_button button_type="reset" content="Cancel" %}
    </form>

{% endblock %}
<div id="alert" style="display:none;"></div>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
{% bootstrap_javascript %}
<script>
  $(function(){
    $('#uploadFileForm').on('submit', function(event) {
      event.preventDefault();
      var formData=new FormData();
      formData.append('file',$("#id_pdfUpload").prop("files")[0])
      formData.append('csrfmiddlewaretoken',$($("#uploadFileForm").children("input[name=csrfmiddlewaretoken]")[0]).val())
      $.ajax({
        url: '{% url "translator:uploadFileAndTranslate" %}',
        type: 'POST',
        data: formData,
        contentType: false,
        cache: false,
        processData:false,
        success: function(response) {
          if (response.success) {
            $('#uploadFileForm').hide();
            $('#alert').html('<div class="alert alert-success">Thank you for your message!</div>').show();
          } else {
            $('#alert').html('<div class="alert alert-danger">' + response.errors + '</div>').show();
          }
        }
      });
    });
  })
</script>
</body>
</html>